<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>
        <record id="view_mechanical_work_order_tree" model="ir.ui.view">
            <field name="name">view.mechanical.work.order.tree</field>
            <field name="model">mechanical.work.order</field>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <tree string="Work Orders" decoration-danger="check_dead_line">
                    <field name="name"/>
                    <field name="work_order_date"/>
                    <field name="check_dead_line" invisible="1"/>
                    <field name="work_customer_id"/>
                    <field name="work_project_id" invisible="1"/>
                </tree>
            </field>
        </record>
        <record id="view_mechanical_work_order_form" model="ir.ui.view">
            <field name="name">view.mechanical.work.order.form</field>
            <field name="model">mechanical.work.order</field>
            <field name="priority" eval="8"/>
            <field name="arch" type="xml">
                <form string="Work Order">
                    <header>
                        <!--                        <button name="create_invoice" type="object" string="Create Invoice" class="oe_highlight"-->
                        <!--                                attrs="{'invisible': ['|',('invoice_count', '!=', 0),('state','!=','finish')]}"/>-->
                        <button name="start_work" type="object" string="Start" class="oe_highlight"
                                attrs="{'invisible': [('state','!=','draft')]}"/>
                        <button name="finish_work" type="object" string="Finish" class="oe_highlight"
                                attrs="{'invisible':[('state','!=','running')]}"/>
                        <button name="generate_completion_certificate" type="object" string="Completion Certificate"
                                class="oe_highlight" states="finish"/>
                        <button name="check_availability" type="object" string="Check Availability"
                                attrs="{'invisible': [('state','!=','waiting_material')]}"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,confirm,done"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button type="object" name="action_view_material_request" class="oe_stat_button"
                                    icon="fa-file"
                                    attrs="{'invisible':[('material_request_count', '=', 0)]}">
                                <field name="material_request_count" widget="statinfo" string="Material Request"/>
                            </button>
                            <button type="object" name="action_view_invoice" class="oe_stat_button"
                                    icon="fa-pencil-square-o"
                                    attrs="{'invisible':[('invoice_count', '=', 0)]}">
                                <field name="invoice_count" widget="statinfo" string="Invoice"/>
                            </button>
                            <button type="object" name="action_view_tasks" class="oe_stat_button"
                                    icon="fa-calendar"
                                    attrs="{'invisible':[('task_count', '=', 0)]}">
                                <field name="task_count" widget="statinfo" string="Task"/>
                            </button>
                            <button type="object" name="action_view_completion_certificate" class="oe_stat_button"
                                    icon="fa-check-circle"
                                    attrs="{'invisible':[('completion_certificate_count', '=', 0)]}">
                                <field name="completion_certificate_count" widget="statinfo" string="Certificate"/>
                            </button>
                        </div>
                        <div class="oe_title">
                            <h1>
                                <field name="name" readonly="True"/>
                            </h1>
                        </div>
                        <group>
                            <group>
                                <field name="work_order_date"/>
                                <field name="work_customer_id"/>
                                <field name="sale_order_reference" invisible="1" context="{'form_view_ref': 'mechanical_services.view_mechanical_order_form'}"/>
                            </group>
                            <group>
                                <field name="work_site_ref" widget="many2many_tags"/>
                                <field name="work_customer_address"/>
                                <field name="mechanical_order_picking_id" invisible="1"/>
                            </group>
                            <group>
                                <label for="completion_time" string="Completion Time"/>
                                <div>
                                    <field name="completion_time" class="oe_inline" nolabel="1"/>
                                    days
                                </div>
                                <label for="warranty_days" string="Warranty"/>
                                <div>
                                    <field name="warranty_days" class="oe_inline" nolabel="1"/>
                                    days
                                </div>
                                <!--                                <field name="warranty"/>-->
                                <field name="payment_term_id"/>
                                <field name="check_dead_line" invisible="1"/>
                            </group>
                            <group>
                                <field name="work_project_id" invisible="1"/>
                                <field name="quotation_id" attrs='{"invisible": [("quotation_id", "=", False)]}'/>
                                <field name="enquiry_id" attrs='{"invisible": [("enquiry_id", "=", False)]}'/>
                                <field name="check_task_status" invisible="1"/>
                            </group>
                        </group>
                        <notebook>
                            <page id="work_scope_tab" string="Mechanical Scope">
                                <field name="mechanical_work_scope_line_ids" mode="tree">
                                    <tree editable="bottom" multi_edit="1">
                                        <field name="mechanical_work_scope_id"/>
                                        <field name="mechanical_work_scope_code"/>
                                        <field name="mechanical_work_scope_description"/>
                                        <field name="mechanical_work_qty"/>
                                        <field name="mechanical_work_scope_price"/>
                                        <field name="mechanical_work_tax" widget="many2many_tags" optional="show"/>
                                        <field name="mechanical_work_tax_amount" optional="hide"/>
                                        <field name="mechanical_work_subtotal"/>
                                        <field name="mechanical_work_total"/>
                                    </tree>
                                </field>
                            </page>
                            <page id="spare_parts_tabs" string="Mechanical Accessories">
                                <field name="mechanical_work_spare_line_ids">
                                    <tree editable="bottom" decoration-danger="state not in ['assigned', 'done']"
                                          multi_edit="1">
                                        <field name="product_id" domain="[('type', '=', 'product')]"/>
                                        <field name="name" invisible="1"/>
                                        <field name="picking_type_id" optional="hide"/>
                                        <field name="product_uom" invisible="1"/>
                                        <field name="location_id" optional="hide"/>
                                        <field name="location_dest_id" optional="hide"/>
                                        <field name="product_uom_qty" string="Quantity"/>
                                        <field name="reserved_availability" string="Reserved"/>
                                        <field name="price_unit" string="Price"/>
                                        <field name="quantity_done" optional="hide"/>
                                        <field name="product_uom_category_id" invisible="1"/>
                                        <field name="company_id" invisible="1"/>
                                        <field name="state" invisible="1"/>
                                        <field name="picking_id" invisible="1"/>
                                    </tree>
                                </field>
                            </page>
                            <page string="Technician Details">
                                <field name="mechanical_technician_ids">
                                    <tree editable="bottom">
                                        <field name="work_order_id" invisible="1"/>
                                        <field name="technician_id"/>
                                        <field name="technician_phone"/>
                                    </tree>
                                </field>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="activity_ids" widget="mail_activity"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>
        <record model="ir.actions.act_window" id="action_menu_work_order">
            <field name="name">Mechanical Work Order</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mechanical.work.order</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[]</field>
            <field name="context">{}</field>
            <field name="help" type="html">
                <p class="o_view_nocontent_smiling_face">
                    Work Orders
                </p>
                <p>
                    Create Work Order.Can Create invoice , Completion Certificate and makes Transfers of product.
                    User can create a Material request while less product stock.
                </p>
            </field>
        </record>
        <!-- This Menu Item Must have a parent -->
        <menuitem id="work_order_main_menu" name="Work Orders" parent="mechanical_service_main_menu" sequence="2"/>
        <menuitem id="menu_mechanical_work_order" name="Work Orders" parent="work_order_main_menu"
                  action="action_menu_work_order"/>
    </data>
</odoo>